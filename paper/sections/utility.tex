\section{Utility Functions for the Reverse Pass} \label{app:utility}
    We define an utility function \texttt{getAncestors} in Listing \ref{lst:getanc}, which gets the computational graph ancestors of a step in the forward pass/trace.

    \begin{haskell}[caption=Function to get ancestors from a node in the trace, label=lst:getanc, gobble=8]
        getAncestors :: Forward -> String -> [String]
        getAncestors f s = case Map.lookup f s of
            Just (_, t, _) -> case t of
                FLift _     -> []
                FOp0  _     -> []
                FOp1  _ a   -> [a]
                FOp2  _ a b -> [a, b]
                FMap  _ a   -> [a]
                FMapV _ a   -> [a]
            Nothing        -> []
    \end{haskell}